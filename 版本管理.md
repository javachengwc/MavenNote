####版本管理
#####何为版本管理
理想的发布版本应当对应了项目某个时刻比较稳定的状态，这包括源代码的状态以及构建的状态，因此这个时候项目的构建应当满足以下的条件：
- **所有自动化测试应当全部通过**
- **项目没有配置任何快照版本的依赖**
- **项目没有配置任何快照版本的插件**
- **项目所包含的代码已经全部提交到版本控制系统中**

只有满足以上条件时，才可以将快照版本更新为发布版本。
将项目的快照版本更新至发布版本之后，应当再执行一次Maven构建，以确保项目状态是健康的。然后将这一变更提交到版本控制系统的主干中。接着再为当前主干的状态打上标签。以Subversion为例，这几个步骤对应的命令如下：

    mvn clean install
    svn commit pom.xml -m "prepare to release 1.0"
    svn copy -m "tag release 1.0"\
    https://svn.juvenxu.com/project/trunk\
    https://svn.juvenxu.com/project/tags/1.0
至此，一个版本的发布的过程完成了。接下来要做的就是更新发布版本至新的快照版本，如从1.0到1.1-SNASHOT。
#####Maven的版本号定义约定
<code><主版本>.<次版本>.<增量版本>-<里程碑版本></code>
- **主版本：**表示项目的重大架构变更。
- **次版本：**表示较大范围内的功能增加和变化，及Bug修复。
- **增量版本：**一般表示重大Bug的修复。
- **里程碑版本：**顾名思义，这往往是指某一个版本的里程碑。

>需要注意的是，不是每一个版本号都必须拥有这四个部分。一般来说，主版本和次版本都会声明，但增量版本和里程碑就不一定了。
#####主干、标签与分支
- **主干：**项目开发代码的主体，是从项目开始直到当前都处于活动的状态。从这里可以获得项目最新的源代码以及几乎所有的变更历史。
- **分支：**从主干的某个点分离出来的代码拷贝，通常可以在不影响主干的前提下在这里进行重大Bug的修复，或者做出一些实验性质的开发。如果分支达到了预期的目的，通常发生在这里的变更会被合并到主干中。
- **标签：**用来标识主干或者分支的某个点的状态，以及代表项目的某个稳定状态，这通常就是版本发布时的状态。

#####自动化版本发布
当熟悉了版本发布流程之后，就会希望借助工具将这一流程自动化。Maven Release Plugin就提供了这样的功能，只要提供了一些必要的信息，它就能帮我们完成上述所有版本发布涉及的操作。
Maven Release Plugin主要有三个目标，它们分别是：
- **release：prepare**准备版本发布，依次执行下列操作：
	检查项目是否有未提交的代码
	检查项目是否有快照版本依赖
	根据用户的输入将快照版本升级为发布版
	将POM中的SCM信息更新为标签地址
	基于修改后的POM执行Maven构建
	提交POM变更
	基于用户输入为代码打标签
	将代码从发布版升级为新的快照版
	提交POM变更
- **release：rollback**回退release:prepare所执行的操作。将POM回退至release:prepare之前的状态，并提交。需要注意的是，该步骤不会删除release:prepare生成的标签，因此用户需要手动删除。
- **release：perform**执行版本发布。签出release:prepare生成的标签中的源代码，并在此基础上执行<code>mvn deploy</code>命令打包并部署构建至仓库。
